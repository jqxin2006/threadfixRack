<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="vulnerabilityTemplateText" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<queryString>
		<![CDATA[SELECT
     organization.`id` AS organization_id,
     organization.`name` AS organization_name,
     application.`id` AS application_id,
     application.`name` AS application_name,
     application.`url` AS application_url,
     vulnerability.`id` AS vulnerability_id,
     vulnerability.`closeTime` AS vulnerability_closeTime,
     vulnerability.`isActive` AS vulnerability_isActive,
     vulnerability.`openTime` AS vulnerability_openTime,
     surfacelocation.`parameter` AS surfacelocation_parameter,
     surfacelocation.`path` AS surfacelocation_path,
     genericvulnerability.`name` AS genericvulnerability_name
FROM
     `organization` organization INNER JOIN `application` application ON organization.`id` = application.`OrganizationId`
     INNER JOIN `vulnerability` vulnerability ON application.`id` = vulnerability.`ApplicationId`
     INNER JOIN `finding` finding ON vulnerability.`id` = finding.`VulnerabilityId`
     INNER JOIN `genericvulnerability` genericvulnerability ON vulnerability.`GenericVulnerabilityId` = genericvulnerability.`id`
     INNER JOIN `surfacelocation` surfacelocation ON finding.`SurfaceLocationId` = surfacelocation.`id`]]>
	</queryString>
	<field name="organization_id" class="java.lang.Integer"/>
	<field name="organization_name" class="java.lang.String"/>
	<field name="application_id" class="java.lang.Integer"/>
	<field name="application_name" class="java.lang.String"/>
	<field name="application_url" class="java.lang.String"/>
	<field name="vulnerability_id" class="java.lang.Integer"/>
	<field name="vulnerability_closeTime" class="java.sql.Timestamp"/>
	<field name="vulnerability_isActive" class="java.lang.Boolean"/>
	<field name="vulnerability_openTime" class="java.sql.Timestamp"/>
	<field name="surfacelocation_parameter" class="java.lang.String"/>
	<field name="surfacelocation_path" class="java.lang.String"/>
	<field name="genericvulnerability_name" class="java.lang.String"/>
	<group name="organizationGroup">
		<groupExpression><![CDATA[$F{organization_name}]]></groupExpression>
		<groupHeader>
			<band height="20">
				<textField>
					<reportElement x="0" y="0" width="125" height="20"/>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{organization_name}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="20"/>
		</groupFooter>
	</group>
	<group name="applicationGroup">
		<groupExpression><![CDATA[$F{application_id}]]></groupExpression>
		<groupHeader>
			<band height="20">
				<textField>
					<reportElement x="0" y="0" width="25" height="20"/>
					<textElement/>
					<textFieldExpression class="java.lang.Integer"><![CDATA[$F{application_id}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="25" y="0" width="150" height="20"/>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{application_name}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="198" y="0" width="374" height="20"/>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{application_url}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="20"/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch">
			<textField pattern="EEEEE dd MMMMM yyyy">
				<reportElement x="472" y="0" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.util.Date"><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="20" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement x="35" y="0" width="125" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{genericvulnerability_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="198" y="0" width="139" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{surfacelocation_path}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="373" y="0" width="67" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{surfacelocation_parameter}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch">
			<textField>
				<reportElement x="523" y="34" width="49" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
